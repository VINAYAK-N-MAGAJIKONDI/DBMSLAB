CREATE TABLE STUDENT ( USN VARCHAR(10) PRIMARY KEY, SName VARCHAR(50), Address VARCHAR(100), Phone VARCHAR(15), Gender VARCHAR(10) );
CREATE TABLE SEMSEC ( SSID INTEGER PRIMARY KEY, Sem INTEGER, Sec CHAR(1) );
CREATE TABLE CLASS ( USN VARCHAR(10) references STUDENT, SSID INTEGER references SEMSEC, PRIMARY KEY (USN, SSID) );
CREATE TABLE SUBJECT ( Subcode VARCHAR(10) PRIMARY KEY, Title VARCHAR(50), Sem INTEGER, Credits INTEGER );
CREATE TABLE IA_MARKS ( USN VARCHAR(10) references STUDENT, Subcode VARCHAR(10), SSID INTEGER references SEMSEC, Test1 FLOAT, Test2 FLOAT, Test3 FLOAT, FinalIA FLOAT, PRIMARY KEY (USN, Subcode, SSID) );

INSERT INTO STUDENT VALUES ('1XX1234', 'John Doe', 'Bangalore', '9876543210', 'Male');
INSERT INTO STUDENT VALUES ('1XX1235', 'Jane Smith', 'Mysore', '8765432109', 'Female');
INSERT INTO STUDENT VALUES ('1XX1236', 'Alex Johnson', 'Delhi', '7654321098', 'Male');
INSERT INTO STUDENT VALUES ('1XX1237', 'Sarah Williams', 'Mumbai', '6543210987', 'Female');
INSERT INTO STUDENT VALUES ('1XX1238', 'David Brown', 'Chennai', '5432109876', 'Male');
INSERT INTO STUDENT VALUES ('1XX1239', 'Emily Davis', 'Kolkata', '4321098765', 'Female');
INSERT INTO STUDENT VALUES ('1XX1240', 'Michael Wilson', 'Hyderabad', '3210987654', 'Male');
INSERT INTO STUDENT VALUES ('1XX1241', 'Lisa Anderson', 'Pune', '2109876543', 'Female');

INSERT INTO SEMSEC VALUES (1, 4, 'C');
INSERT INTO SEMSEC VALUES (2, 4, 'A');
INSERT INTO SEMSEC VALUES (3, 4, 'B');
INSERT INTO SEMSEC VALUES (4, 8, 'A');
INSERT INTO SEMSEC VALUES (5, 8, 'B');
INSERT INTO SEMSEC VALUES (6, 8, 'C');
INSERT INTO SEMSEC VALUES (7, 6, 'A');
INSERT INTO SEMSEC VALUES (8, 6, 'B');

INSERT INTO CLASS VALUES ('1XX1234', 1);
INSERT INTO CLASS VALUES ('1XX1235', 1);
INSERT INTO CLASS VALUES ('1XX1236', 3);
INSERT INTO CLASS VALUES ('1XX1237', 2);
INSERT INTO CLASS VALUES ('1XX1238', 4);
INSERT INTO CLASS VALUES ('1XX1239', 5);
INSERT INTO CLASS VALUES ('1XX1240', 6);
INSERT INTO CLASS VALUES ('1XX1241', 6);

INSERT INTO SUBJECT VALUES ('CS101', 'Database Systems', 4, 4);
INSERT INTO SUBJECT VALUES ('CS102', 'Data Structures', 4, 4);
INSERT INTO SUBJECT VALUES ('CS103', 'Computer Networks', 4, 4);
INSERT INTO SUBJECT VALUES ('CS104', 'Operating Systems', 8, 4);
INSERT INTO SUBJECT VALUES ('CS105', 'Software Engineering', 8, 4);
INSERT INTO SUBJECT VALUES ('CS106', 'Web Development', 8, 4);
INSERT INTO SUBJECT VALUES ('CS107', 'Machine Learning', 6, 4);
INSERT INTO SUBJECT VALUES ('CS108', 'Artificial Intelligence', 6, 4);

INSERT INTO IA_MARKS VALUES ('1XX1234', 'CS101', 1, 18, 19, 20, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1234', 'CS102', 1, 17, 15, 16, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1234', 'CS103', 1, 13, 14, 15, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1235', 'CS101', 1, 19, 18, 17, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1235', 'CS102', 1, 15, 16, 17, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1236', 'CS101', 3, 10, 11, 12, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1238', 'CS104', 4, 19, 20, 18, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1239', 'CS104', 5, 15, 16, 14, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1240', 'CS104', 6, 9, 10, 11, NULL);
INSERT INTO IA_MARKS VALUES ('1XX1241', 'CS104', 6, 10, 9, 8, NULL);

SELECT s.*
FROM STUDENT s
JOIN CLASS c ON s.USN = c.USN
JOIN SEMSEC ss ON c.SSID = ss.SSID
WHERE ss.Sem = 4 AND ss.Sec = 'C';
SELECT ss.Sem, ss.Sec, 
       SUM(CASE WHEN s.Gender = 'Male' THEN 1 ELSE 0 END) AS Male_Count,
       SUM(CASE WHEN s.Gender = 'Female' THEN 1 ELSE 0 END) AS Female_Count
FROM STUDENT s
JOIN CLASS c ON s.USN = c.USN
JOIN SEMSEC ss ON c.SSID = ss.SSID
GROUP BY ss.Sem, ss.Sec;
CREATE VIEW Student_1XX1234_Test1 AS
SELECT s.Title AS Subject, i.Test1
FROM IA_MARKS i
JOIN SUBJECT s ON i.Subcode = s.Subcode
WHERE i.USN = '1XX1234';
UPDATE IA_MARKS
SET FinalIA = (
    CASE
        WHEN Test1 >= Test2 AND Test1 >= Test3 THEN
            CASE
                WHEN Test2 >= Test3 THEN (Test1 + Test2) / 2
                ELSE (Test1 + Test3) / 2
            END
        WHEN Test2 >= Test1 AND Test2 >= Test3 THEN
            CASE
                WHEN Test1 >= Test3 THEN (Test2 + Test1) / 2
                ELSE (Test2 + Test3) / 2
            END
        ELSE
            CASE
                WHEN Test1 >= Test2 THEN (Test3 + Test1) / 2
                ELSE (Test3 + Test2) / 2
            END
    END
);
SELECT s.USN, s.SName, ss.Sec, i.FinalIA,
       CASE
           WHEN i.FinalIA >= 17 AND i.FinalIA <= 20 THEN 'Outstanding'
           WHEN i.FinalIA >= 12 AND i.FinalIA <= 16 THEN 'Average'
           WHEN i.FinalIA < 12 THEN 'Weak'
       END AS CAT
FROM STUDENT s
JOIN CLASS c ON s.USN = c.USN
JOIN SEMSEC ss ON c.SSID = ss.SSID
JOIN IA_MARKS i ON s.USN = i.USN AND ss.SSID = i.SSID
WHERE ss.Sem = 8 AND (ss.Sec = 'A' OR ss.Sec = 'B' OR ss.Sec = 'C');
